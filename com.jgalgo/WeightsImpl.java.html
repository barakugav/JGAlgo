<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>WeightsImpl.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JGAlgo - Core</a> &gt; <a href="index.source.html" class="el_package">com.jgalgo</a> &gt; <span class="el_source">WeightsImpl.java</span></div><h1>WeightsImpl.java</h1><pre class="source lang-java linenums">/*-
 * Copyright 2023 Barak Ugav
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package com.jgalgo;

import java.util.Collections;
import java.util.Map;
import java.util.Objects;
import java.util.Set;
import it.unimi.dsi.fastutil.objects.Object2ObjectArrayMap;

interface WeightsImpl&lt;E&gt; extends Weights&lt;E&gt; {

	DataContainer&lt;E&gt; container();

	WeightsImpl&lt;E&gt; copy(IDStrategyImpl idStrat);

	@SuppressWarnings(&quot;unchecked&quot;)
	default WeightsImpl&lt;E&gt; unmodifiable() {
<span class="nc bnc" id="L33" title="All 2 branches missed.">		if (this instanceof UnmodifiableWeights&lt;?&gt;)</span>
<span class="nc" id="L34">			return this;</span>
<span class="nc bnc" id="L35" title="All 2 branches missed.">		if (this instanceof Weights.Byte)</span>
<span class="nc" id="L36">			return (WeightsImpl&lt;E&gt;) new UnmodifiableWeights.Byte((Weights.Byte) this);</span>
<span class="nc bnc" id="L37" title="All 2 branches missed.">		if (this instanceof Weights.Short)</span>
<span class="nc" id="L38">			return (WeightsImpl&lt;E&gt;) new UnmodifiableWeights.Short((Weights.Short) this);</span>
<span class="nc bnc" id="L39" title="All 2 branches missed.">		if (this instanceof Weights.Int)</span>
<span class="nc" id="L40">			return (WeightsImpl&lt;E&gt;) new UnmodifiableWeights.Int((Weights.Int) this);</span>
<span class="nc bnc" id="L41" title="All 2 branches missed.">		if (this instanceof Weights.Long)</span>
<span class="nc" id="L42">			return (WeightsImpl&lt;E&gt;) new UnmodifiableWeights.Long((Weights.Long) this);</span>
<span class="nc bnc" id="L43" title="All 2 branches missed.">		if (this instanceof Weights.Float)</span>
<span class="nc" id="L44">			return (WeightsImpl&lt;E&gt;) new UnmodifiableWeights.Float((Weights.Float) this);</span>
<span class="nc bnc" id="L45" title="All 2 branches missed.">		if (this instanceof Weights.Double)</span>
<span class="nc" id="L46">			return (WeightsImpl&lt;E&gt;) new UnmodifiableWeights.Double((Weights.Double) this);</span>
<span class="nc bnc" id="L47" title="All 2 branches missed.">		if (this instanceof Weights.Bool)</span>
<span class="nc" id="L48">			return (WeightsImpl&lt;E&gt;) new UnmodifiableWeights.Bool((Weights.Bool) this);</span>
<span class="nc bnc" id="L49" title="All 2 branches missed.">		if (this instanceof Weights.Char)</span>
<span class="nc" id="L50">			return (WeightsImpl&lt;E&gt;) new UnmodifiableWeights.Char((Weights.Char) this);</span>
<span class="nc" id="L51">		return new UnmodifiableWeights&lt;&gt;(this);</span>
	}

	@SuppressWarnings(&quot;unchecked&quot;)
	static &lt;E, WeightsT extends Weights&lt;E&gt;&gt; WeightsT newInstance(IDStrategyImpl idStrat, Class&lt;? super E&gt; type,
			E defVal) {
<span class="fc" id="L57">		DataContainer&lt;E&gt; container = DataContainer.newInstance(idStrat, type, defVal);</span>
<span class="fc" id="L58">		boolean isContinues = idStrat instanceof IDStrategyImpl.Continues;</span>
<span class="fc bfc" id="L59" title="All 2 branches covered.">		return (WeightsT) (isContinues ? wrapContainerDirected(container) : wrapContainerMapped(container, idStrat));</span>
	}

	private static Weights&lt;?&gt; wrapContainerDirected(DataContainer&lt;?&gt; container) {
<span class="fc bfc" id="L63" title="All 2 branches covered.">		if (container instanceof DataContainer.Obj&lt;?&gt;) {</span>
<span class="fc" id="L64">			return new WeightsImpl.Direct.Obj&lt;&gt;((DataContainer.Obj&lt;?&gt;) container);</span>
<span class="fc bfc" id="L65" title="All 2 branches covered.">		} else if (container instanceof DataContainer.Byte) {</span>
<span class="fc" id="L66">			return new WeightsImpl.Direct.Byte((DataContainer.Byte) container);</span>
<span class="fc bfc" id="L67" title="All 2 branches covered.">		} else if (container instanceof DataContainer.Short) {</span>
<span class="fc" id="L68">			return new WeightsImpl.Direct.Short((DataContainer.Short) container);</span>
<span class="fc bfc" id="L69" title="All 2 branches covered.">		} else if (container instanceof DataContainer.Int) {</span>
<span class="fc" id="L70">			return new WeightsImpl.Direct.Int((DataContainer.Int) container);</span>
<span class="fc bfc" id="L71" title="All 2 branches covered.">		} else if (container instanceof DataContainer.Long) {</span>
<span class="fc" id="L72">			return new WeightsImpl.Direct.Long((DataContainer.Long) container);</span>
<span class="fc bfc" id="L73" title="All 2 branches covered.">		} else if (container instanceof DataContainer.Float) {</span>
<span class="fc" id="L74">			return new WeightsImpl.Direct.Float((DataContainer.Float) container);</span>
<span class="fc bfc" id="L75" title="All 2 branches covered.">		} else if (container instanceof DataContainer.Double) {</span>
<span class="fc" id="L76">			return new WeightsImpl.Direct.Double((DataContainer.Double) container);</span>
<span class="fc bfc" id="L77" title="All 2 branches covered.">		} else if (container instanceof DataContainer.Bool) {</span>
<span class="fc" id="L78">			return new WeightsImpl.Direct.Bool((DataContainer.Bool) container);</span>
<span class="pc bpc" id="L79" title="1 of 2 branches missed.">		} else if (container instanceof DataContainer.Char) {</span>
<span class="fc" id="L80">			return new WeightsImpl.Direct.Char((DataContainer.Char) container);</span>
		} else {
<span class="nc" id="L82">			throw new IllegalArgumentException(container.getClass().toString());</span>
		}
	}

	private static Weights&lt;?&gt; wrapContainerMapped(DataContainer&lt;?&gt; container, IDStrategyImpl idStrat) {
<span class="fc bfc" id="L87" title="All 2 branches covered.">		if (container instanceof DataContainer.Obj&lt;?&gt;) {</span>
<span class="fc" id="L88">			return new WeightsImpl.Mapped.Obj&lt;&gt;((DataContainer.Obj&lt;?&gt;) container, idStrat);</span>
<span class="fc bfc" id="L89" title="All 2 branches covered.">		} else if (container instanceof DataContainer.Byte) {</span>
<span class="fc" id="L90">			return new WeightsImpl.Mapped.Byte((DataContainer.Byte) container, idStrat);</span>
<span class="fc bfc" id="L91" title="All 2 branches covered.">		} else if (container instanceof DataContainer.Short) {</span>
<span class="fc" id="L92">			return new WeightsImpl.Mapped.Short((DataContainer.Short) container, idStrat);</span>
<span class="fc bfc" id="L93" title="All 2 branches covered.">		} else if (container instanceof DataContainer.Int) {</span>
<span class="fc" id="L94">			return new WeightsImpl.Mapped.Int((DataContainer.Int) container, idStrat);</span>
<span class="fc bfc" id="L95" title="All 2 branches covered.">		} else if (container instanceof DataContainer.Long) {</span>
<span class="fc" id="L96">			return new WeightsImpl.Mapped.Long((DataContainer.Long) container, idStrat);</span>
<span class="fc bfc" id="L97" title="All 2 branches covered.">		} else if (container instanceof DataContainer.Float) {</span>
<span class="fc" id="L98">			return new WeightsImpl.Mapped.Float((DataContainer.Float) container, idStrat);</span>
<span class="fc bfc" id="L99" title="All 2 branches covered.">		} else if (container instanceof DataContainer.Double) {</span>
<span class="fc" id="L100">			return new WeightsImpl.Mapped.Double((DataContainer.Double) container, idStrat);</span>
<span class="fc bfc" id="L101" title="All 2 branches covered.">		} else if (container instanceof DataContainer.Bool) {</span>
<span class="fc" id="L102">			return new WeightsImpl.Mapped.Bool((DataContainer.Bool) container, idStrat);</span>
<span class="pc bpc" id="L103" title="1 of 2 branches missed.">		} else if (container instanceof DataContainer.Char) {</span>
<span class="fc" id="L104">			return new WeightsImpl.Mapped.Char((DataContainer.Char) container, idStrat);</span>
		} else {
<span class="nc" id="L106">			throw new IllegalArgumentException(container.getClass().toString());</span>
		}
	}

	static abstract class Abstract&lt;E&gt; implements WeightsImpl&lt;E&gt; {

		private final DataContainer&lt;E&gt; container;

<span class="fc" id="L114">		private Abstract(DataContainer&lt;E&gt; container) {</span>
<span class="fc" id="L115">			this.container = container;</span>
<span class="fc" id="L116">		}</span>

		@Override
		public DataContainer&lt;E&gt; container() {
<span class="fc" id="L120">			return container;</span>
		}
	}

	static abstract class Direct&lt;E&gt; extends WeightsImpl.Abstract&lt;E&gt; {
		private Direct(DataContainer&lt;E&gt; data) {
<span class="fc" id="L126">			super(data);</span>
<span class="fc" id="L127">		}</span>

		static class Obj&lt;E&gt; extends Direct&lt;E&gt; {
			Obj(DataContainer.Obj&lt;E&gt; container) {
<span class="fc" id="L131">				super(container);</span>
<span class="fc" id="L132">			}</span>

			@Override
			public DataContainer.Obj&lt;E&gt; container() {
<span class="fc" id="L136">				return (DataContainer.Obj&lt;E&gt;) super.container();</span>
			}

			@Override
			public E get(int id) {
<span class="fc" id="L141">				return container().get(id);</span>
			}

			@Override
			public void set(int id, E val) {
<span class="fc" id="L146">				container().set(id, val);</span>
<span class="fc" id="L147">			}</span>

			@Override
			public E defaultWeight() {
<span class="fc" id="L151">				return container().defaultVal();</span>
			}

			@Override
			public WeightsImpl.Direct.Obj&lt;E&gt; copy(IDStrategyImpl idStrat) {
<span class="fc" id="L156">				return new WeightsImpl.Direct.Obj&lt;&gt;(container().copy(idStrat));</span>
			}
		}

		static class Byte extends Direct&lt;java.lang.Byte&gt; implements Weights.Byte {
			Byte(DataContainer.Byte container) {
<span class="fc" id="L162">				super(container);</span>
<span class="fc" id="L163">			}</span>

			@Override
			public DataContainer.Byte container() {
<span class="fc" id="L167">				return (DataContainer.Byte) super.container();</span>
			}

			@Override
			public byte getByte(int id) {
<span class="fc" id="L172">				return container().getByte(id);</span>
			}

			@Override
			public void set(int key, byte weight) {
<span class="fc" id="L177">				container().set(key, weight);</span>
<span class="fc" id="L178">			}</span>

			@Override
			public byte defaultWeightByte() {
<span class="fc" id="L182">				return container().defaultValByte();</span>
			}

			@Override
			public WeightsImpl.Direct.Byte copy(IDStrategyImpl idStrat) {
<span class="nc" id="L187">				return new WeightsImpl.Direct.Byte(container().copy(idStrat));</span>
			}
		}

		static class Short extends Direct&lt;java.lang.Short&gt; implements Weights.Short {
			Short(DataContainer.Short container) {
<span class="fc" id="L193">				super(container);</span>
<span class="fc" id="L194">			}</span>

			@Override
			public DataContainer.Short container() {
<span class="fc" id="L198">				return (DataContainer.Short) super.container();</span>
			}

			@Override
			public short getShort(int id) {
<span class="fc" id="L203">				return container().getShort(id);</span>
			}

			@Override
			public void set(int key, short weight) {
<span class="fc" id="L208">				container().set(key, weight);</span>
<span class="fc" id="L209">			}</span>

			@Override
			public short defaultWeightShort() {
<span class="fc" id="L213">				return container().defaultValShort();</span>
			}

			@Override
			public WeightsImpl.Direct.Short copy(IDStrategyImpl idStrat) {
<span class="nc" id="L218">				return new WeightsImpl.Direct.Short(container().copy(idStrat));</span>
			}
		}

		static class Int extends Direct&lt;Integer&gt; implements Weights.Int {
			Int(DataContainer.Int container) {
<span class="fc" id="L224">				super(container);</span>
<span class="fc" id="L225">			}</span>

			@Override
			public DataContainer.Int container() {
<span class="fc" id="L229">				return (DataContainer.Int) super.container();</span>
			}

			@Override
			public int getInt(int id) {
<span class="fc" id="L234">				return container().getInt(id);</span>
			}

			@Override
			public void set(int id, int weight) {
<span class="fc" id="L239">				container().set(id, weight);</span>
<span class="fc" id="L240">			}</span>

			@Override
			public int defaultWeightInt() {
<span class="fc" id="L244">				return container().defaultValInt();</span>
			}

			@Override
			public WeightsImpl.Direct.Int copy(IDStrategyImpl idStrat) {
<span class="nc" id="L249">				return new WeightsImpl.Direct.Int(container().copy(idStrat));</span>
			}
		}

		static class Long extends Direct&lt;java.lang.Long&gt; implements Weights.Long {
			Long(DataContainer.Long container) {
<span class="fc" id="L255">				super(container);</span>
<span class="fc" id="L256">			}</span>

			@Override
			public DataContainer.Long container() {
<span class="fc" id="L260">				return (DataContainer.Long) super.container();</span>
			}

			@Override
			public long getLong(int id) {
<span class="fc" id="L265">				return container().getLong(id);</span>
			}

			@Override
			public void set(int key, long weight) {
<span class="fc" id="L270">				container().set(key, weight);</span>
<span class="fc" id="L271">			}</span>

			@Override
			public long defaultWeightLong() {
<span class="fc" id="L275">				return container().defaultValLong();</span>
			}

			@Override
			public WeightsImpl.Direct.Long copy(IDStrategyImpl idStrat) {
<span class="nc" id="L280">				return new WeightsImpl.Direct.Long(container().copy(idStrat));</span>
			}
		}

		static class Float extends Direct&lt;java.lang.Float&gt; implements Weights.Float {
			Float(DataContainer.Float container) {
<span class="fc" id="L286">				super(container);</span>
<span class="fc" id="L287">			}</span>

			@Override
			public DataContainer.Float container() {
<span class="fc" id="L291">				return (DataContainer.Float) super.container();</span>
			}

			@Override
			public float getFloat(int id) {
<span class="fc" id="L296">				return container().getFloat(id);</span>
			}

			@Override
			public void set(int key, float weight) {
<span class="fc" id="L301">				container().set(key, weight);</span>
<span class="fc" id="L302">			}</span>

			@Override
			public float defaultWeightFloat() {
<span class="fc" id="L306">				return container().defaultValFloat();</span>
			}

			@Override
			public WeightsImpl.Direct.Float copy(IDStrategyImpl idStrat) {
<span class="nc" id="L311">				return new WeightsImpl.Direct.Float(container().copy(idStrat));</span>
			}
		}

		static class Double extends Direct&lt;java.lang.Double&gt; implements Weights.Double {
			Double(DataContainer.Double container) {
<span class="fc" id="L317">				super(container);</span>
<span class="fc" id="L318">			}</span>

			@Override
			public DataContainer.Double container() {
<span class="fc" id="L322">				return (DataContainer.Double) super.container();</span>
			}

			@Override
			public double getDouble(int id) {
<span class="fc" id="L327">				return container().getDouble(id);</span>
			}

			@Override
			public void set(int key, double weight) {
<span class="fc" id="L332">				container().set(key, weight);</span>
<span class="fc" id="L333">			}</span>

			@Override
			public double defaultWeightDouble() {
<span class="fc" id="L337">				return container().defaultValDouble();</span>
			}

			@Override
			public WeightsImpl.Direct.Double copy(IDStrategyImpl idStrat) {
<span class="nc" id="L342">				return new WeightsImpl.Direct.Double(container().copy(idStrat));</span>
			}
		}

		static class Bool extends Direct&lt;Boolean&gt; implements Weights.Bool {
			Bool(DataContainer.Bool container) {
<span class="fc" id="L348">				super(container);</span>
<span class="fc" id="L349">			}</span>

			@Override
			public DataContainer.Bool container() {
<span class="fc" id="L353">				return (DataContainer.Bool) super.container();</span>
			}

			@Override
			public boolean getBool(int id) {
<span class="fc" id="L358">				return container().getBool(id);</span>
			}

			@Override
			public void set(int id, boolean weight) {
<span class="fc" id="L363">				container().set(id, weight);</span>
<span class="fc" id="L364">			}</span>

			@Override
			public boolean defaultWeightBool() {
<span class="fc" id="L368">				return container().defaultValBool();</span>
			}

			@Override
			public WeightsImpl.Direct.Bool copy(IDStrategyImpl idStrat) {
<span class="nc" id="L373">				return new WeightsImpl.Direct.Bool(container().copy(idStrat));</span>
			}
		}

		static class Char extends Direct&lt;Character&gt; implements Weights.Char {
			Char(DataContainer.Char container) {
<span class="fc" id="L379">				super(container);</span>
<span class="fc" id="L380">			}</span>

			@Override
			public DataContainer.Char container() {
<span class="fc" id="L384">				return (DataContainer.Char) super.container();</span>
			}

			@Override
			public char getChar(int id) {
<span class="fc" id="L389">				return container().getChar(id);</span>
			}

			@Override
			public void set(int id, char weight) {
<span class="fc" id="L394">				container().set(id, weight);</span>
<span class="fc" id="L395">			}</span>

			@Override
			public char defaultWeightChar() {
<span class="fc" id="L399">				return container().defaultValChar();</span>
			}

			@Override
			public WeightsImpl.Direct.Char copy(IDStrategyImpl idStrat) {
<span class="nc" id="L404">				return new WeightsImpl.Direct.Char(container().copy(idStrat));</span>
			}
		}
	}

	static abstract class Mapped&lt;E&gt; extends WeightsImpl.Abstract&lt;E&gt; {

		final IDStrategyImpl idStrategy;

		private Mapped(DataContainer&lt;E&gt; data, IDStrategyImpl idStrategy) {
<span class="fc" id="L414">			super(data);</span>
<span class="fc" id="L415">			this.idStrategy = idStrategy;</span>
<span class="fc" id="L416">		}</span>

		static class Obj&lt;E&gt; extends Mapped&lt;E&gt; {
			Obj(DataContainer.Obj&lt;E&gt; container, IDStrategyImpl idStrategy) {
<span class="fc" id="L420">				super(container, idStrategy);</span>
<span class="fc" id="L421">			}</span>

			@Override
			public DataContainer.Obj&lt;E&gt; container() {
<span class="fc" id="L425">				return (DataContainer.Obj&lt;E&gt;) super.container();</span>
			}

			@Override
			public E get(int id) {
<span class="fc" id="L430">				return container().get(idStrategy.idToIdx(id));</span>
			}

			@Override
			public void set(int id, E val) {
<span class="fc" id="L435">				container().set(idStrategy.idToIdx(id), val);</span>
<span class="fc" id="L436">			}</span>

			@Override
			public E defaultWeight() {
<span class="fc" id="L440">				return container().defaultVal();</span>
			}

			@Override
			public WeightsImpl.Mapped.Obj&lt;E&gt; copy(IDStrategyImpl idStrat) {
<span class="fc" id="L445">				return new WeightsImpl.Mapped.Obj&lt;&gt;(container().copy(idStrat), idStrat);</span>
			}
		}

		static class Byte extends Mapped&lt;java.lang.Byte&gt; implements Weights.Byte {
			Byte(DataContainer.Byte container, IDStrategyImpl idStrategy) {
<span class="fc" id="L451">				super(container, idStrategy);</span>
<span class="fc" id="L452">			}</span>

			@Override
			public DataContainer.Byte container() {
<span class="fc" id="L456">				return (DataContainer.Byte) super.container();</span>
			}

			@Override
			public byte getByte(int id) {
<span class="fc" id="L461">				return container().getByte(idStrategy.idToIdx(id));</span>
			}

			@Override
			public void set(int id, byte weight) {
<span class="fc" id="L466">				container().set(idStrategy.idToIdx(id), weight);</span>
<span class="fc" id="L467">			}</span>

			@Override
			public byte defaultWeightByte() {
<span class="fc" id="L471">				return container().defaultValByte();</span>
			}

			@Override
			public WeightsImpl.Mapped.Byte copy(IDStrategyImpl idStrat) {
<span class="nc" id="L476">				return new WeightsImpl.Mapped.Byte(container().copy(idStrat), idStrat);</span>
			}
		}

		static class Short extends Mapped&lt;java.lang.Short&gt; implements Weights.Short {
			Short(DataContainer.Short container, IDStrategyImpl idStrategy) {
<span class="fc" id="L482">				super(container, idStrategy);</span>
<span class="fc" id="L483">			}</span>

			@Override
			public DataContainer.Short container() {
<span class="fc" id="L487">				return (DataContainer.Short) super.container();</span>
			}

			@Override
			public short getShort(int id) {
<span class="fc" id="L492">				return container().getShort(idStrategy.idToIdx(id));</span>
			}

			@Override
			public void set(int id, short weight) {
<span class="fc" id="L497">				container().set(idStrategy.idToIdx(id), weight);</span>
<span class="fc" id="L498">			}</span>

			@Override
			public short defaultWeightShort() {
<span class="fc" id="L502">				return container().defaultValShort();</span>
			}

			@Override
			public WeightsImpl.Mapped.Short copy(IDStrategyImpl idStrat) {
<span class="nc" id="L507">				return new WeightsImpl.Mapped.Short(container().copy(idStrat), idStrat);</span>
			}
		}

		static class Int extends Mapped&lt;Integer&gt; implements Weights.Int {
			Int(DataContainer.Int container, IDStrategyImpl idStrategy) {
<span class="fc" id="L513">				super(container, idStrategy);</span>
<span class="fc" id="L514">			}</span>

			@Override
			public DataContainer.Int container() {
<span class="fc" id="L518">				return (DataContainer.Int) super.container();</span>
			}

			@Override
			public int getInt(int id) {
<span class="fc" id="L523">				return container().getInt(idStrategy.idToIdx(id));</span>
			}

			@Override
			public void set(int id, int weight) {
<span class="fc" id="L528">				container().set(idStrategy.idToIdx(id), weight);</span>
<span class="fc" id="L529">			}</span>

			@Override
			public int defaultWeightInt() {
<span class="fc" id="L533">				return container().defaultValInt();</span>
			}

			@Override
			public WeightsImpl.Mapped.Int copy(IDStrategyImpl idStrat) {
<span class="nc" id="L538">				return new WeightsImpl.Mapped.Int(container().copy(idStrat), idStrat);</span>
			}
		}

		static class Long extends Mapped&lt;java.lang.Long&gt; implements Weights.Long {
			Long(DataContainer.Long container, IDStrategyImpl idStrategy) {
<span class="fc" id="L544">				super(container, idStrategy);</span>
<span class="fc" id="L545">			}</span>

			@Override
			public DataContainer.Long container() {
<span class="fc" id="L549">				return (DataContainer.Long) super.container();</span>
			}

			@Override
			public long getLong(int id) {
<span class="fc" id="L554">				return container().getLong(idStrategy.idToIdx(id));</span>
			}

			@Override
			public void set(int id, long weight) {
<span class="fc" id="L559">				container().set(idStrategy.idToIdx(id), weight);</span>
<span class="fc" id="L560">			}</span>

			@Override
			public long defaultWeightLong() {
<span class="fc" id="L564">				return container().defaultValLong();</span>
			}

			@Override
			public WeightsImpl.Mapped.Long copy(IDStrategyImpl idStrat) {
<span class="nc" id="L569">				return new WeightsImpl.Mapped.Long(container().copy(idStrat), idStrat);</span>
			}
		}

		static class Float extends Mapped&lt;java.lang.Float&gt; implements Weights.Float {
			Float(DataContainer.Float container, IDStrategyImpl idStrategy) {
<span class="fc" id="L575">				super(container, idStrategy);</span>
<span class="fc" id="L576">			}</span>

			@Override
			public DataContainer.Float container() {
<span class="fc" id="L580">				return (DataContainer.Float) super.container();</span>
			}

			@Override
			public float getFloat(int id) {
<span class="fc" id="L585">				return container().getFloat(idStrategy.idToIdx(id));</span>
			}

			@Override
			public void set(int id, float weight) {
<span class="fc" id="L590">				container().set(idStrategy.idToIdx(id), weight);</span>
<span class="fc" id="L591">			}</span>

			@Override
			public float defaultWeightFloat() {
<span class="fc" id="L595">				return container().defaultValFloat();</span>
			}

			@Override
			public WeightsImpl.Mapped.Float copy(IDStrategyImpl idStrat) {
<span class="nc" id="L600">				return new WeightsImpl.Mapped.Float(container().copy(idStrat), idStrat);</span>
			}
		}

		static class Double extends Mapped&lt;java.lang.Double&gt; implements Weights.Double {
			Double(DataContainer.Double container, IDStrategyImpl idStrategy) {
<span class="fc" id="L606">				super(container, idStrategy);</span>
<span class="fc" id="L607">			}</span>

			@Override
			public DataContainer.Double container() {
<span class="fc" id="L611">				return (DataContainer.Double) super.container();</span>
			}

			@Override
			public double getDouble(int id) {
<span class="fc" id="L616">				return container().getDouble(idStrategy.idToIdx(id));</span>
			}

			@Override
			public void set(int id, double weight) {
<span class="fc" id="L621">				container().set(idStrategy.idToIdx(id), weight);</span>
<span class="fc" id="L622">			}</span>

			@Override
			public double defaultWeightDouble() {
<span class="fc" id="L626">				return container().defaultValDouble();</span>
			}

			@Override
			public WeightsImpl.Mapped.Double copy(IDStrategyImpl idStrat) {
<span class="nc" id="L631">				return new WeightsImpl.Mapped.Double(container().copy(idStrat), idStrat);</span>
			}
		}

		static class Bool extends Mapped&lt;Boolean&gt; implements Weights.Bool {
			Bool(DataContainer.Bool container, IDStrategyImpl idStrategy) {
<span class="fc" id="L637">				super(container, idStrategy);</span>
<span class="fc" id="L638">			}</span>

			@Override
			public DataContainer.Bool container() {
<span class="fc" id="L642">				return (DataContainer.Bool) super.container();</span>
			}

			@Override
			public boolean getBool(int id) {
<span class="fc" id="L647">				return container().getBool(idStrategy.idToIdx(id));</span>
			}

			@Override
			public void set(int id, boolean weight) {
<span class="fc" id="L652">				container().set(idStrategy.idToIdx(id), weight);</span>
<span class="fc" id="L653">			}</span>

			@Override
			public boolean defaultWeightBool() {
<span class="fc" id="L657">				return container().defaultValBool();</span>
			}

			@Override
			public WeightsImpl.Mapped.Bool copy(IDStrategyImpl idStrat) {
<span class="nc" id="L662">				return new WeightsImpl.Mapped.Bool(container().copy(idStrat), idStrat);</span>
			}
		}

		static class Char extends Mapped&lt;Character&gt; implements Weights.Char {
			Char(DataContainer.Char container, IDStrategyImpl idStrategy) {
<span class="fc" id="L668">				super(container, idStrategy);</span>
<span class="fc" id="L669">			}</span>

			@Override
			public DataContainer.Char container() {
<span class="fc" id="L673">				return (DataContainer.Char) super.container();</span>
			}

			@Override
			public char getChar(int id) {
<span class="fc" id="L678">				return container().getChar(idStrategy.idToIdx(id));</span>
			}

			@Override
			public void set(int id, char weight) {
<span class="fc" id="L683">				container().set(idStrategy.idToIdx(id), weight);</span>
<span class="fc" id="L684">			}</span>

			@Override
			public char defaultWeightChar() {
<span class="fc" id="L688">				return container().defaultValChar();</span>
			}

			@Override
			public WeightsImpl.Mapped.Char copy(IDStrategyImpl idStrat) {
<span class="nc" id="L693">				return new WeightsImpl.Mapped.Char(container().copy(idStrat), idStrat);</span>
			}
		}
	}

<span class="fc" id="L698">	static class Manager extends DataContainer.Manager {</span>

<span class="fc" id="L700">		private final Map&lt;Object, WeightsImpl&lt;?&gt;&gt; weights = new Object2ObjectArrayMap&lt;&gt;();</span>

		Manager(int initialCapacity) {
<span class="fc" id="L703">			super(initialCapacity);</span>
<span class="fc" id="L704">		}</span>

		Manager(Manager orig, IDStrategyImpl idStrat) {
<span class="fc" id="L707">			this(idStrat.size());</span>
<span class="fc bfc" id="L708" title="All 2 branches covered.">			for (var entry : orig.weights.entrySet())</span>
<span class="fc" id="L709">				addWeights(entry.getKey(), entry.getValue().copy(idStrat));</span>
<span class="fc" id="L710">		}</span>

		@Override
		Manager copy(IDStrategyImpl idStrat) {
<span class="fc" id="L714">			return new Manager(this, idStrat);</span>
		}

		@SuppressWarnings(&quot;unchecked&quot;)
		&lt;E, WeightsT extends Weights&lt;E&gt;&gt; WeightsT getWeights(Object key) {
<span class="fc" id="L719">			return (WeightsT) weights.get(key);</span>
		}

		@Override
		final void addContainer(Object key, DataContainer&lt;?&gt; container) {
<span class="nc" id="L724">			throw new UnsupportedOperationException();</span>
		}

		void addWeights(Object key, Weights&lt;?&gt; weights) {
<span class="fc" id="L728">			super.addContainer(key, ((WeightsImpl&lt;?&gt;) weights).container());</span>
<span class="fc" id="L729">			Object o = this.weights.put(key, (WeightsImpl&lt;?&gt;) weights);</span>
<span class="pc bpc" id="L730" title="1 of 2 branches missed.">			assert o == null;</span>
<span class="fc" id="L731">		}</span>

		void removeWeights(Object key) {
<span class="nc" id="L734">			Object o1 = weights.remove(key);</span>
<span class="nc bnc" id="L735" title="All 2 branches missed.">			if (o1 == null)</span>
<span class="nc" id="L736">				return;</span>
<span class="nc" id="L737">			Object o2 = containers.remove(key);</span>
<span class="nc bnc" id="L738" title="All 2 branches missed.">			assert o2 != null;</span>
<span class="nc" id="L739">		}</span>

		Set&lt;Object&gt; weightsKeys() {
<span class="fc" id="L742">			return Collections.unmodifiableSet(weights.keySet());</span>
		}

	}

	static class UnmodifiableWeights&lt;E&gt; implements WeightsImpl&lt;E&gt; {

		private final WeightsImpl&lt;E&gt; weights;

<span class="nc" id="L751">		UnmodifiableWeights(Weights&lt;E&gt; w) {</span>
<span class="nc" id="L752">			this.weights = (WeightsImpl&lt;E&gt;) Objects.requireNonNull(w);</span>
<span class="nc" id="L753">		}</span>

		@Override
		public DataContainer&lt;E&gt; container() {
<span class="nc" id="L757">			return weights.container();</span>
		}

		@Override
		public WeightsImpl&lt;E&gt; copy(IDStrategyImpl idStrat) {
<span class="nc" id="L762">			return weights.copy(idStrat);</span>
		}

		Weights&lt;E&gt; weights() {
<span class="nc" id="L766">			return weights;</span>
		}

		@Override
		public E get(int id) {
<span class="nc" id="L771">			return weights.get(id);</span>
		}

		@Override
		public void set(int id, E weight) {
<span class="nc" id="L776">			throw new UnsupportedOperationException();</span>
		}

		@Override
		public E defaultWeight() {
<span class="nc" id="L781">			return weights.defaultWeight();</span>
		}

		static class Byte extends UnmodifiableWeights&lt;java.lang.Byte&gt; implements Weights.Byte {
			Byte(Weights.Byte w) {
<span class="nc" id="L786">				super(w);</span>
<span class="nc" id="L787">			}</span>

			@Override
			Weights.Byte weights() {
<span class="nc" id="L791">				return (Weights.Byte) super.weights();</span>
			}

			@Override
			public byte getByte(int id) {
<span class="nc" id="L796">				return weights().getByte(id);</span>
			}

			@Override
			public void set(int id, byte weight) {
<span class="nc" id="L801">				throw new UnsupportedOperationException();</span>
			}

			@Override
			public byte defaultWeightByte() {
<span class="nc" id="L806">				return weights().defaultWeightByte();</span>
			}
		}

		static class Short extends UnmodifiableWeights&lt;java.lang.Short&gt; implements Weights.Short {
			Short(Weights.Short w) {
<span class="nc" id="L812">				super(w);</span>
<span class="nc" id="L813">			}</span>

			@Override
			Weights.Short weights() {
<span class="nc" id="L817">				return (Weights.Short) super.weights();</span>
			}

			@Override
			public short getShort(int id) {
<span class="nc" id="L822">				return weights().getShort(id);</span>
			}

			@Override
			public void set(int id, short weight) {
<span class="nc" id="L827">				throw new UnsupportedOperationException();</span>
			}

			@Override
			public short defaultWeightShort() {
<span class="nc" id="L832">				return weights().defaultWeightShort();</span>
			}
		}

		static class Int extends UnmodifiableWeights&lt;Integer&gt; implements Weights.Int {
			Int(Weights.Int w) {
<span class="nc" id="L838">				super(w);</span>
<span class="nc" id="L839">			}</span>

			@Override
			Weights.Int weights() {
<span class="nc" id="L843">				return (Weights.Int) super.weights();</span>
			}

			@Override
			public int getInt(int id) {
<span class="nc" id="L848">				return weights().getInt(id);</span>
			}

			@Override
			public void set(int id, int weight) {
<span class="nc" id="L853">				throw new UnsupportedOperationException();</span>
			}

			@Override
			public int defaultWeightInt() {
<span class="nc" id="L858">				return weights().defaultWeightInt();</span>
			}
		}

		static class Long extends UnmodifiableWeights&lt;java.lang.Long&gt; implements Weights.Long {
			Long(Weights.Long w) {
<span class="nc" id="L864">				super(w);</span>
<span class="nc" id="L865">			}</span>

			@Override
			Weights.Long weights() {
<span class="nc" id="L869">				return (Weights.Long) super.weights();</span>
			}

			@Override
			public long getLong(int id) {
<span class="nc" id="L874">				return weights().getLong(id);</span>
			}

			@Override
			public void set(int id, long weight) {
<span class="nc" id="L879">				throw new UnsupportedOperationException();</span>
			}

			@Override
			public long defaultWeightLong() {
<span class="nc" id="L884">				return weights().defaultWeightLong();</span>
			}
		}

		static class Float extends UnmodifiableWeights&lt;java.lang.Float&gt; implements Weights.Float {
			Float(Weights.Float w) {
<span class="nc" id="L890">				super(w);</span>
<span class="nc" id="L891">			}</span>

			@Override
			Weights.Float weights() {
<span class="nc" id="L895">				return (Weights.Float) super.weights();</span>
			}

			@Override
			public float getFloat(int id) {
<span class="nc" id="L900">				return weights().getFloat(id);</span>
			}

			@Override
			public void set(int id, float weight) {
<span class="nc" id="L905">				throw new UnsupportedOperationException();</span>
			}

			@Override
			public float defaultWeightFloat() {
<span class="nc" id="L910">				return weights().defaultWeightFloat();</span>
			}
		}

		static class Double extends UnmodifiableWeights&lt;java.lang.Double&gt; implements Weights.Double {
			Double(Weights.Double w) {
<span class="nc" id="L916">				super(w);</span>
<span class="nc" id="L917">			}</span>

			@Override
			Weights.Double weights() {
<span class="nc" id="L921">				return (Weights.Double) super.weights();</span>
			}

			@Override
			public double getDouble(int id) {
<span class="nc" id="L926">				return weights().getDouble(id);</span>
			}

			@Override
			public void set(int id, double weight) {
<span class="nc" id="L931">				throw new UnsupportedOperationException();</span>
			}

			@Override
			public double defaultWeightDouble() {
<span class="nc" id="L936">				return weights().defaultWeightDouble();</span>
			}
		}

		static class Bool extends UnmodifiableWeights&lt;Boolean&gt; implements Weights.Bool {
			Bool(Weights.Bool w) {
<span class="nc" id="L942">				super(w);</span>
<span class="nc" id="L943">			}</span>

			@Override
			Weights.Bool weights() {
<span class="nc" id="L947">				return (Weights.Bool) super.weights();</span>
			}

			@Override
			public boolean getBool(int id) {
<span class="nc" id="L952">				return weights().getBool(id);</span>
			}

			@Override
			public void set(int id, boolean weight) {
<span class="nc" id="L957">				throw new UnsupportedOperationException();</span>
			}

			@Override
			public boolean defaultWeightBool() {
<span class="nc" id="L962">				return weights().defaultWeightBool();</span>
			}
		}

		static class Char extends UnmodifiableWeights&lt;Character&gt; implements Weights.Char {
			Char(Weights.Char w) {
<span class="nc" id="L968">				super(w);</span>
<span class="nc" id="L969">			}</span>

			@Override
			Weights.Char weights() {
<span class="nc" id="L973">				return (Weights.Char) super.weights();</span>
			}

			@Override
			public char getChar(int id) {
<span class="nc" id="L978">				return weights().getChar(id);</span>
			}

			@Override
			public void set(int id, char weight) {
<span class="nc" id="L983">				throw new UnsupportedOperationException();</span>
			}

			@Override
			public char defaultWeightChar() {
<span class="nc" id="L988">				return weights().defaultWeightChar();</span>
			}
		}
	}

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>